import{K as j,l as A,Q as I,N as M,r as _,i as n,e as t,p as x,v as C,t as u,n as m,k as f,E as N,f as h,d as B,w as F,G as P,g as b,F as S,z as q,s as Q,m as D,o as d}from"./vendor-BHuxT6k0.js";import{r as O}from"./qr-C9nJ0eoO.js";import{_ as L}from"./_plugin-vue_export-helper-DlAUqK2U.js";var U=O();const E=j(U),V={components:{Link:A},props:{books:{type:Array,required:!0},myRequests:{type:Array,required:!1,default:()=>[]},notifications:{type:Array,required:!1,default:()=>[]}},data(){return{searchQuery:"",sortBy:"title-asc",ageFilter:null,showQrModal:!1,qrModalSvg:"",qrModalBookId:null,qrModalBookTitle:"",showToast:!1,toastMessage:"",isModalOpen:!1,isProfileModalOpen:!1,isNotificationModalOpen:!1,isTransactionModalOpen:!1,isBorrowedModalOpen:!1,showDropdown:!1,showProfileDetails:!1,showScannerModal:!1,scannerActive:!1,scanStream:null,scanIntervalId:null,scannedCode:null,facingMode:"environment",uploadedQrPreview:null,uploadedQrFile:null,showSidebar:!1,selectedBook:null,requestType:"",startDate:"",returnDate:"",profileForm:{fullname:"",email:"",phone_number:""}}},mounted(){document.addEventListener("click",this.handleDocumentClick),document.addEventListener("keydown",this.handleKeydown)},beforeUnmount(){document.removeEventListener("click",this.handleDocumentClick),document.removeEventListener("keydown",this.handleKeydown),this.stopScanner()},computed:{user(){return I().props.auth.user},userInitial(){return this.user.fullname.charAt(0)},filteredBooks(){let a=this.books.filter(l=>l.title.toLowerCase().includes(this.searchQuery.toLowerCase())||l.author.toLowerCase().includes(this.searchQuery.toLowerCase())||l.course&&l.course.toLowerCase().includes(this.searchQuery.toLowerCase()));this.ageFilter&&(a=a.filter(l=>{const i=this.getBookAge(l);switch(this.ageFilter){case"new":return i<=2;case"recent":return i>=3&&i<=4;case"moderate":return i>=5&&i<=6;case"older":return i>=7&&i<=9;case"old":return i>=10;default:return!0}}));const e=[...a];switch(this.sortBy){case"title-asc":e.sort((i,r)=>i.title.localeCompare(r.title));break;case"title-desc":e.sort((i,r)=>r.title.localeCompare(i.title));break;case"author-asc":e.sort((i,r)=>i.author.localeCompare(r.author));break;case"author-desc":e.sort((i,r)=>r.author.localeCompare(i.author));break;case"course-asc":e.sort((i,r)=>(i.course||"").localeCompare(r.course||""));break;case"course-desc":e.sort((i,r)=>(r.course||"").localeCompare(i.course||""));break;case"availability":const l={Available:1,Reserved:2,Borrowed:3};e.sort((i,r)=>(l[i.availability]||999)-(l[r.availability]||999));break;case"age-newest":e.sort((i,r)=>this.getBookAge(i)-this.getBookAge(r));break;case"age-oldest":e.sort((i,r)=>this.getBookAge(r)-this.getBookAge(i));break}return e},unreadNotificationsCount(){return!this.notifications||!Array.isArray(this.notifications)?0:this.notifications.filter(a=>!a.read).length},returnDateMin(){if(!this.startDate)return null;const a=this.startDate.split("-");if(a.length!==3)return this.startDate;const e=parseInt(a[0],10),l=parseInt(a[1],10)-1,i=parseInt(a[2],10);if(this.requestType==="reserve"){const r=new Date(e,l,i+1),o=r.getFullYear(),c=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");return`${o}-${c}-${s}`}return this.startDate}},watch:{requestType(a){a==="borrow"&&this.startDate?this.setReturnDateForBorrow():a==="reserve"&&this.startDate&&this.setReturnDateForReserve()},startDate(a){this.requestType==="borrow"&&a?this.setReturnDateForBorrow():this.requestType==="reserve"&&a&&this.setReturnDateForReserve()}},methods:{toggleDropdown(){this.showDropdown=!this.showDropdown,this.showDropdown||(this.showProfileDetails=!1)},toggleProfileDetails(){this.showProfileDetails=!this.showProfileDetails},handleDocumentClick(a){try{const e=this.$refs.dropdown,l=this.$refs.profileBtn;this.showDropdown&&e&&l&&!e.contains(a.target)&&!l.contains(a.target)&&(this.showDropdown=!1,this.showProfileDetails=!1)}catch{}},handleKeydown(a){a.key==="Escape"&&this.showDropdown&&(this.showDropdown=!1,this.showProfileDetails=!1)},async openScannerModal(){this.showScannerModal=!0,this.$nextTick(()=>this.startScanner())},async closeScannerModal(){this.showScannerModal=!1,this.uploadedQrPreview=null,this.uploadedQrFile=null,await this.stopScanner()},async loadJsQR(){return window.jsQR?window.jsQR:new Promise((a,e)=>{const l=document.createElement("script");l.src="https://unpkg.com/jsqr/dist/jsQR.js",l.onload=()=>a(window.jsQR),l.onerror=e,document.head.appendChild(l)})},async startScanner(){if(!this.scannerActive)try{const a=await this.loadJsQR(),e={video:{facingMode:this.facingMode,width:{ideal:1280},height:{ideal:720}}},l=await navigator.mediaDevices.getUserMedia(e);this.scanStream=l;const i=this.$refs.scanVideo;i.srcObject=l,await i.play(),this.scannerActive=!0;const r=this.$refs.scanCanvas,o=r.getContext("2d");this.scanIntervalId=setInterval(()=>{if(i.readyState===i.HAVE_ENOUGH_DATA){r.width=i.videoWidth,r.height=i.videoHeight,o.drawImage(i,0,0,r.width,r.height);try{const c=o.getImageData(0,0,r.width,r.height),s=a(c.data,c.width,c.height);if(s&&s.data){this.scannedCode=s.data,console.log("QR Code Scanned:",this.scannedCode);const g=String(this.scannedCode).trim();console.log("Looking for book with ID:",g),console.log("Available books:",this.books.map(p=>({id:p.id,bookId:p.bookId,title:p.title})));const v=this.books.find(p=>String(p.bookId).trim()===g);v?(console.log("Book found!",v),this.showToast=!0,this.toastMessage=`Book found: ${v.title}`,setTimeout(()=>this.showToast=!1,2500),this.closeScannerModal(),setTimeout(()=>{this.openModal(v)},300)):(console.log("Book NOT found for ID:",g),this.searchQuery=this.scannedCode,this.showToast=!0,this.toastMessage="Code scanned but book not found. Scanned: "+g,setTimeout(()=>this.showToast=!1,4e3),this.closeScannerModal())}}catch(c){console.error("Scanner error:",c)}}},250)}catch(a){console.error("Scanner start failed",a),this.showToast=!0,this.toastMessage="Unable to access camera. Please allow camera permission.",setTimeout(()=>this.showToast=!1,3e3),this.showScannerModal=!1}},async toggleFacing(){this.facingMode=this.facingMode==="environment"?"user":"environment",this.scannerActive&&(await this.stopScanner(),setTimeout(()=>this.startScanner(),300))},async stopScanner(){try{this.scanIntervalId&&(clearInterval(this.scanIntervalId),this.scanIntervalId=null),this.scanStream&&(this.scanStream.getTracks().forEach(a=>a.stop()),this.scanStream=null),this.scannerActive=!1}catch{}},previewUploadedQr(a){const e=a.target.files[0];if(!e)return;this.uploadedQrFile=e;const l=new FileReader;l.onload=i=>{this.uploadedQrPreview=i.target.result},l.readAsDataURL(e)},async scanUploadedQr(){if(!this.uploadedQrFile){this.showToast=!0,this.toastMessage="Please select an image first",setTimeout(()=>this.showToast=!1,2e3);return}try{const a=new Image;a.onload=()=>{const e=document.createElement("canvas"),l=e.getContext("2d");e.width=a.width,e.height=a.height,l.drawImage(a,0,0);const i=l.getImageData(0,0,e.width,e.height),r=E(i.data,i.width,i.height);if(r&&r.data){this.scannedCode=r.data,console.log("QR Code from uploaded image:",this.scannedCode);const o=String(this.scannedCode).trim();console.log("Looking for book with ID:",o);const c=this.books.find(s=>String(s.bookId).trim()===o);c?(console.log("Book found!",c),this.showToast=!0,this.toastMessage=`Book found: ${c.title}`,setTimeout(()=>this.showToast=!1,2500),this.closeScannerModal(),this.uploadedQrPreview=null,this.uploadedQrFile=null,setTimeout(()=>{this.openModal(c)},300)):(console.log("Book NOT found for ID:",o),this.showToast=!0,this.toastMessage="Book not found. Scanned ID: "+o,setTimeout(()=>this.showToast=!1,4e3))}else this.showToast=!0,this.toastMessage="No QR code detected in the image. Please try another image.",setTimeout(()=>this.showToast=!1,3e3);this.$refs.qrFileInput&&(this.$refs.qrFileInput.value="")},a.src=this.uploadedQrPreview}catch(a){console.error("Error processing QR image:",a),this.showToast=!0,this.toastMessage="Error processing image. Please try again.",setTimeout(()=>this.showToast=!1,3e3)}},async copyStudentId(){const a=this.user&&this.user.studentid?String(this.user.studentid):"";if(a)try{if(navigator.clipboard&&navigator.clipboard.writeText)await navigator.clipboard.writeText(a);else{const e=document.createElement("textarea");e.value=a,document.body.appendChild(e),e.select(),document.execCommand("copy"),e.remove()}this.showToast=!0,this.toastMessage="Student ID copied to clipboard.",setTimeout(()=>this.showToast=!1,2e3)}catch(e){console.error(e)}},toggleSidebar(){this.showSidebar=!this.showSidebar},openNotificationModal(){this.isNotificationModalOpen=!0,this.showSidebar=!1},closeNotificationModal(){this.isNotificationModalOpen=!1},openTransactionModal(){this.isTransactionModalOpen=!0,this.showSidebar=!1},closeTransactionModal(){this.isTransactionModalOpen=!1},openBorrowedModal(){this.isBorrowedModalOpen=!0,this.showSidebar=!1},closeBorrowedModal(){this.isBorrowedModalOpen=!1},openModal(a){this.selectedBook=a,this.requestType="",this.startDate="",this.returnDate="",this.isModalOpen=!0,console.log("Modal opened for book:",a.title)},onStartDateChange(){this.startDate&&(this.requestType==="borrow"?this.setReturnDateForBorrow():this.requestType==="reserve"&&this.setReturnDateForReserve())},closeModal(){this.isModalOpen=!1,this.selectedBook=null,this.requestType="",this.startDate="",this.returnDate=""},submitRequest(){this.requestType==="reserve"?M.post(route("student.reserve-book"),{book_id:this.selectedBook.id,reservation_date:this.startDate,return_date:this.returnDate},{onSuccess:()=>{this.closeModal(),this.showToast=!0,this.toastMessage="Reservation submitted successfully!",setTimeout(()=>this.showToast=!1,3e3)},onError:a=>{console.error(a);const e=a&&a[Object.keys(a)[0]]&&a[Object.keys(a)[0]][0]||"Failed to submit reservation";this.showToast=!0,this.toastMessage=e,setTimeout(()=>this.showToast=!1,4e3)}}):this.requestType==="borrow"&&M.post(route("book-requests.store"),{book_id:this.selectedBook.id,request_type:"borrow",request_date:this.startDate,return_date:this.returnDate},{onSuccess:()=>{this.closeModal(),this.showToast=!0,this.toastMessage="Borrow request submitted successfully!",setTimeout(()=>this.showToast=!1,3e3)},onError:a=>{console.error(a);const e=a&&a[Object.keys(a)[0]]&&a[Object.keys(a)[0]][0]||"Failed to submit request";this.showToast=!0,this.toastMessage=e,setTimeout(()=>this.showToast=!1,4e3)}})},openProfileModal(){this.profileForm.fullname=this.user.fullname,this.profileForm.email=this.user.email,this.profileForm.phone_number=this.user.phone_number,this.isProfileModalOpen=!0},closeProfileModal(){this.isProfileModalOpen=!1},updateProfile(){M.put(route("profile.update.basic"),this.profileForm,{onSuccess:()=>{this.closeProfileModal()},onError:a=>{console.log(a)}})},async viewQrCode(a,e){var l,i;try{console.log("Fetching QR code for book ID:",a);const r=await fetch(`/books/${a}/qrcode`,{headers:{Accept:"application/json","X-Requested-With":"XMLHttpRequest"}});if(console.log("Response status:",r.status),!r.ok){const s=await r.json().catch(()=>({}));throw console.error("Server error:",s),new Error(s.error||"Failed to fetch QR code")}const o=await r.json();if(console.log("QR code data received:",{hasQrCodeSvg:!!o.qrCodeSvg,svgLength:(l=o.qrCodeSvg)==null?void 0:l.length,svgPreview:(i=o.qrCodeSvg)==null?void 0:i.substring(0,100),bookId:o.bookId,bookTitle:o.bookTitle}),o.error)throw console.error("QR code error:",o.error),new Error(o.error);if(!o.qrCodeSvg||typeof o.qrCodeSvg!="string")throw console.error("Invalid QR code data:",o),new Error("Invalid QR code data received");const c=o.qrCodeSvg.trim();if(!c.startsWith("<?xml")&&!c.startsWith("<svg"))throw console.error("Invalid SVG format. Content starts with:",c.substring(0,50)),new Error("Invalid SVG format received");this.qrModalSvg=o.qrCodeSvg,this.qrModalBookId=a,this.qrModalBookTitle=e,this.showQrModal=!0,console.log("QR modal opened successfully")}catch(r){console.error("viewQrCode error:",r),this.showToast=!0,this.toastMessage="Unable to load QR code: "+r.message,setTimeout(()=>this.showToast=!1,3e3)}},buildNotificationText(a,e="short"){if(a.message&&e==="short")return a.message;const l=a.payload&&typeof a.payload=="object"?a.payload:a.data&&typeof a.data=="object"?a.data:{},i=l.book_title||l.book||"",r=l.user_name||this.user&&this.user.fullname||"You",o=l.request_type||l.requestType||l.type||"request",c=l.request_date||l.requestDate||l.start_date||l.requested_at,s=l.start_date||l.startDate||l.request_date||c,g=l.due_date||l.return_date||l.dueDate,v=l.until_date||l.untilDate||l.available_until,p=l.days_left||l.daysLeft,k=l.reason||l.note||"",T=l.fine_amount||l.fineAmount||l.fine||"",w=R=>R,y=R=>R;switch((a.type||"").toLowerCase()){case"request_submitted":case"request_submitted_notification":case"request_submitted":return e==="short"?w(`Request received â€” ${i} (${o}) is pending review.`):y(`${r}, your ${o} request for "${i}" starting ${this.formatDate(c)} is received and is pending approval.`);case"request_approved":return e==="short"?w(`Request approved: ${i} â€” pick-up/borrow starts ${this.formatDate(s)}.`):y(`Good news, ${r}! Your ${o} request for "${i}" has been approved. Start date: ${this.formatDate(s)}. Due: ${this.formatDate(g)}.`);case"request_rejected":return e==="short"?w(`Request declined: ${i}.`):y(`We're sorry, ${r}. Your ${o} request for "${i}" (start: ${this.formatDate(c)}) was declined. Reason: ${k}. Contact admin for details.`);case"reservation_ready":case"reservation_ready_notification":return e==="short"?w(`Reservation ready: ${i} is available.`):y(`Hi ${r}, the book you reserved â€” "${i}" â€” is now available for pickup. Please collect it by ${this.formatDate(v)}.`);case"due_soon":return e==="short"?w(`Due in ${p||3} days: ${i}`):y(`Reminder: "${i}" is due on ${this.formatDate(g)} (in ${p||3} days). Please return or extend to avoid fines.`);case"due_tomorrow":return e==="short"?w(`Due tomorrow: ${i}`):y(`Heads up â€” "${i}" is due tomorrow (${this.formatDate(g)}). Return or contact the library to extend your loan.`);case"overdue":return e==="short"?w(`Overdue: ${i}`):y(`Overdue notice: "${i}" was due on ${this.formatDate(g)}. Please return it immediately to avoid fines. Current fine: ${T}.`);case"book_returned":return e==="short"?w(`Returned: ${i}`):y(`Your borrowed book "${i}" was marked returned on ${this.formatDate(g||l.returned_at)}.`);default:return a.message?a.message:l&&Object.keys(l).length?JSON.stringify(l):""}},formatDateTime(a){if(!a)return"";try{return new Date(a).toLocaleString("en-US",{year:"numeric",month:"short",day:"numeric",hour:"numeric",minute:"2-digit"})}catch{return a}},downloadQr(){if(this.qrModalSvg)try{const a=document.createElement("div");a.innerHTML=this.qrModalSvg;const e=a.querySelector("svg");if(!e){this.showToast=!0,this.toastMessage="Invalid QR code format",setTimeout(()=>this.showToast=!1,3e3);return}const l=e.width.baseVal.value||200,i=e.height.baseVal.value||200,r=document.createElement("canvas");r.width=l,r.height=i;const o=r.getContext("2d"),c=new Blob([this.qrModalSvg],{type:"image/svg+xml;charset=utf-8"}),s=URL.createObjectURL(c),g=new Image;g.onload=()=>{o.fillStyle="white",o.fillRect(0,0,r.width,r.height),o.drawImage(g,0,0),r.toBlob(v=>{const p=URL.createObjectURL(v),k=document.createElement("a"),T=(this.qrModalBookTitle||"book").replace(/[^a-z0-9-_]/gi,"_").toLowerCase();k.href=p,k.download=`${T}-${this.qrModalBookId||"qr"}.png`,document.body.appendChild(k),k.click(),k.remove(),URL.revokeObjectURL(p),URL.revokeObjectURL(s),this.showToast=!0,this.toastMessage="QR code downloaded as PNG.",setTimeout(()=>this.showToast=!1,3e3)},"image/png")},g.onerror=()=>{this.showToast=!0,this.toastMessage="Failed to convert QR code to image",setTimeout(()=>this.showToast=!1,3e3),URL.revokeObjectURL(s)},g.src=s}catch(a){console.error("Error downloading QR code:",a),this.showToast=!0,this.toastMessage="Failed to download QR code",setTimeout(()=>this.showToast=!1,3e3)}},setReturnDateForBorrow(){if(this.startDate){const a=this.startDate.split("-");if(a.length===3){const e=parseInt(a[0],10),l=parseInt(a[1],10)-1,i=parseInt(a[2],10),r=new Date(e,l,i);r.setDate(r.getDate()+7);const o=r.getFullYear(),c=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");this.returnDate=`${o}-${c}-${s}`}}},setReturnDateForReserve(){if(this.startDate){const a=this.startDate.split("-");if(a.length===3){const e=parseInt(a[0],10),l=parseInt(a[1],10)-1,i=parseInt(a[2],10),r=new Date(e,l,i+1),o=r.getFullYear(),c=String(r.getMonth()+1).padStart(2,"0"),s=String(r.getDate()).padStart(2,"0");this.returnDate=`${o}-${c}-${s}`}}},formatDate(a){return a?new Date(a).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):""},toggleReadStatus(a){M.post(route("notifications.toggle-read",a.id),{},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{},onError:e=>{console.error("Failed to toggle notification status:",e),this.showToast=!0,this.toastMessage="Failed to update notification",setTimeout(()=>this.showToast=!1,3e3)}})},markAllAsRead(){M.post(route("notifications.mark-all-read"),{},{preserveScroll:!0,preserveState:!0,onSuccess:()=>{this.showToast=!0,this.toastMessage="All notifications marked as read",setTimeout(()=>this.showToast=!1,2e3)},onError:a=>{console.error("Failed to mark all as read:",a),this.showToast=!0,this.toastMessage="Failed to mark notifications as read",setTimeout(()=>this.showToast=!1,3e3)}})},deleteNotification(a){confirm("Are you sure you want to delete this notification?")&&M.delete(route("notifications.destroy",a),{preserveScroll:!0,preserveState:!0,onSuccess:()=>{this.showToast=!0,this.toastMessage="Notification deleted",setTimeout(()=>this.showToast=!1,2e3)},onError:e=>{console.error("Failed to delete notification:",e),this.showToast=!0,this.toastMessage="Failed to delete notification",setTimeout(()=>this.showToast=!1,3e3)}})},getBookAgeBorderClass(a){if(!a.publicationDate)return"border-gray-400 hover:border-gray-500";const e=this.getBookAge(a);return e<=2?"border-green-500 hover:border-green-600":e<=4?"border-blue-500 hover:border-blue-600":e<=6?"border-yellow-500 hover:border-yellow-600":e<=9?"border-orange-500 hover:border-orange-600":"border-red-500 hover:border-red-600"},getBookAge(a){if(!a.publicationDate)return 999;const e=new Date(a.publicationDate),l=new Date,i=l.getFullYear()-e.getFullYear();return l.getMonth()<e.getMonth()||l.getMonth()===e.getMonth()&&l.getDate()<e.getDate()?i-1:i},toggleAgeFilter(a){this.ageFilter=this.ageFilter===a?null:a},clearAgeFilter(){this.ageFilter=null}}},H={class:"bg-[#081c2d] text-white py-3 px-4 md:px-6 shadow-sm mb-4 flex flex-col md:flex-row items-center justify-between"},z={class:"w-full md:flex-1 md:mx-6 mt-3 md:mt-0"},Y={class:"flex items-center space-x-4 w-full md:w-auto justify-end mt-3 md:mt-0"},G=["aria-expanded"],W={class:"flex items-center space-x-1"},Z={class:"flex flex-col items-center sm:items-end space-y-0.5 text-center sm:text-right"},K={class:"text-sm font-semibold truncate max-w-[180px]"},J={class:"hidden sm:block"},X={class:"text-xs text-gray-400 truncate max-w-[180px]"},$={class:"text-xs text-gray-400 truncate max-w-[180px]"},ee={key:0,ref:"dropdown",class:"absolute top-12 right-0 w-56 bg-white rounded-lg shadow-md py-2 z-50"},te={class:"px-4 pb-2 border-b"},se={class:"text-sm font-semibold text-gray-800 truncate"},oe={class:"flex items-center justify-between mt-1"},re={class:"text-xs text-gray-500 truncate"},ae={class:"flex items-center justify-between mt-1"},le={class:"text-xs text-gray-500 truncate"},ie={class:"px-4 py-2 border-b text-sm text-gray-700"},ne={class:"truncate"},de={class:"truncate"},ue={class:"truncate"},ce={class:"flex items-center mb-4 space-x-3"},fe={key:0,class:"absolute -top-1 -right-1 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full min-w-[20px] text-center animate-pulse"},ge={key:0,class:"fixed inset-0 z-50 flex"},me={class:"bg-[#081c2d] w-64 h-full shadow-lg p-6 flex flex-col"},he={class:"flex items-center justify-between mb-8"},pe={class:"flex flex-col space-y-4"},be={class:"mb-4"},xe={key:0,class:"ml-2 px-2 py-0.5 bg-red-500 text-white text-xs font-bold rounded-full animate-pulse"},ve={class:"mb-4"},we={class:"mb-4"},ye={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in relative max-h-[85vh] sm:max-h-[70vh] overflow-y-auto"},ke={class:"flex items-center justify-between mb-4"},Me={class:"text-gray-600"},Ce={key:0,class:"text-center py-8"},De={key:1},Se={class:"space-y-2"},Te={key:0,class:"absolute top-3 left-3 w-2 h-2 bg-blue-500 rounded-full animate-pulse"},Re={class:"flex items-start justify-between"},qe={class:"flex-1"},Be={class:"text-sm text-gray-800 font-medium"},Fe={class:"text-xs text-gray-500 mt-1"},Qe={key:0,class:"text-xs text-gray-400 mt-1 flex items-center"},je={class:"flex items-center space-x-2 ml-2 opacity-0 group-hover:opacity-100 transition-opacity"},Ae=["onClick","title"],Ie=["onClick"],_e={key:0,class:"mt-2"},Ne={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in relative max-h-[85vh] sm:max-h-[80vh] overflow-y-auto"},Pe={key:0,class:"text-gray-600"},Oe={key:1},Le={class:"w-full border-collapse text-sm"},Ue={class:"py-2 px-2"},Ee={class:"py-2 px-2 capitalize"},Ve={class:"py-2 px-2"},He={class:"py-2 px-2"},ze={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in relative"},Ye={class:"container mx-auto p-6 md:p-10"},Ge={class:"mb-6 bg-white p-4 rounded-lg shadow-md border border-gray-200"},We={class:"flex flex-wrap gap-3 text-sm"},Ze={class:"flex items-center gap-2 w-full sm:w-auto"},Ke={class:"grid grid-cols-3 gap-4 books-grid"},Je=["onClick"],Xe={class:"w-full h-56 overflow-hidden bg-gray-100 book-cover"},$e=["src"],et={class:"p-4"},tt=["title"],st=["onClick"],ot={class:"text-sm text-gray-600 mt-2"},rt={class:"text-sm text-gray-700 mt-1"},at={class:"font-semibold"},lt={class:"text-sm text-gray-700 mt-1"},it={class:"font-semibold"},nt={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in relative max-h-[90vh] overflow-y-auto"},dt={class:"text-lg font-semibold text-gray-800 mb-4"},ut={key:0,class:"text-sm text-gray-500 font-normal"},ct=["min"],ft={for:"returnDate",class:"block text-sm font-medium text-gray-700"},gt=["min"],mt={class:"flex justify-end space-x-3"},ht=["disabled"],pt={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in max-h-[90vh] overflow-y-auto"},bt={class:"flex justify-end space-x-3"},xt={class:"bg-white rounded-lg shadow-lg p-4 sm:p-6 w-full max-w-full sm:max-w-md md:max-w-lg animate-fade-in relative max-h-[85vh] sm:max-h-[80vh] overflow-y-auto"},vt={class:"text-lg font-semibold text-gray-800 mb-4"},wt=["innerHTML"],yt={key:1,class:"flex justify-center items-center h-48 mb-4"},kt={class:"flex justify-end space-x-3"},Mt=["disabled"],Ct={key:6,class:"fixed inset-0 bg-black bg-opacity-70 flex justify-center items-center z-50 p-4 overflow-y-auto"},Dt={class:"bg-gradient-to-br from-white to-gray-50 rounded-2xl shadow-2xl w-full max-w-5xl mx-auto my-8 overflow-hidden animate-fade-in"},St={class:"bg-gradient-to-r from-blue-600 to-teal-600 px-6 py-4 flex items-center justify-between sticky top-0 z-10"},Tt={class:"p-6 max-h-[calc(100vh-12rem)] overflow-y-auto"},Rt={class:"flex flex-col lg:flex-row gap-6"},qt={class:"lg:flex-1"},Bt={class:"relative rounded-xl overflow-hidden shadow-lg bg-black"},Ft={key:0,class:"absolute inset-0 pointer-events-none"},Qt={class:"absolute top-4 left-1/2 transform -translate-x-1/2"},jt={key:0,class:"px-4 py-2 bg-green-500 text-white rounded-full shadow-lg flex items-center space-x-2 animate-pulse"},At={key:1,class:"px-4 py-2 bg-gray-700 text-white rounded-full shadow-lg"},It={id:"scannerCanvas",ref:"scanCanvas",class:"hidden","aria-hidden":"true"},_t={class:"mt-4 flex items-center justify-between bg-white rounded-xl p-4 shadow-md"},Nt={class:"flex items-center space-x-3"},Pt={class:"text-xs text-gray-500"},Ot={class:"lg:w-96 space-y-4"},Lt={class:"bg-gradient-to-br from-blue-50 to-teal-50 rounded-xl p-5 border-2 border-dashed border-blue-300 shadow-md"},Ut={key:0,class:"mt-4 animate-fade-in"},Et={class:"relative rounded-lg overflow-hidden bg-white p-2 shadow-md"},Vt=["src"],Ht={class:"bg-white rounded-xl p-5 shadow-md border border-gray-200"},zt={class:"bg-gray-50 rounded-lg p-3"},Yt={key:0,class:"text-sm text-gray-800 font-mono break-all"},Gt={key:1,class:"text-sm text-gray-400 italic"},Wt={key:7,class:"fixed bottom-6 right-6 sm:right-6 sm:left-auto left-1/2 transform sm:translate-x-0 -translate-x-1/2 bg-black text-white px-4 py-2 rounded shadow"};function Zt(a,e,l,i,r,o){const c=_("Link");return d(),n(S,null,[t("header",H,[e[51]||(e[51]=t("div",{class:"flex items-center space-x-4 justify-center md:justify-start w-full md:w-auto"},[t("img",{src:"/img/logo2.png",alt:"BOOK CLOUD Logo",class:"max-w-[150px] h-auto"})],-1)),t("div",z,[x(t("input",{id:"search",name:"search",type:"text","onUpdate:modelValue":e[0]||(e[0]=s=>r.searchQuery=s),placeholder:"Search by title, author, or course...",autocomplete:"off",class:"w-full p-2 text-sm border border-gray-300 rounded-lg text-black focus:outline-none focus:ring-2 focus:ring-blue-400 transition-all duration-200"},null,512),[[C,r.searchQuery]])]),t("div",Y,[t("button",{ref:"profileBtn",onClick:e[1]||(e[1]=(...s)=>o.toggleDropdown&&o.toggleDropdown(...s)),"aria-expanded":r.showDropdown,class:"w-10 h-10 rounded-full bg-[#00509e] flex items-center justify-center text-white text-sm font-semibold shadow-md transition-all hover:scale-105 relative"},[e[48]||(e[48]=t("span",{class:"sr-only"},"Open profile menu",-1)),t("span",W,[t("span",null,u(o.userInitial),1),(d(),n("svg",{class:m([{"transform rotate-180":r.showDropdown},"w-3 h-3 transition-transform"]),fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},e[47]||(e[47]=[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M19 9l-7 7-7-7"},null,-1)]),2))])],8,G),t("div",Z,[t("p",K,u(o.user.fullname),1),t("div",J,[t("p",X,u(o.user.studentid),1),t("p",$,u(o.user.phone_number||"No phone number"),1)])]),r.showDropdown?(d(),n("div",ee,[t("div",te,[t("p",se,u(o.user.fullname),1),t("div",oe,[t("p",re,"ID: "+u(o.user.studentid),1),t("button",{onClick:e[2]||(e[2]=(...s)=>o.copyStudentId&&o.copyStudentId(...s)),type:"button",class:"text-xs text-blue-600 hover:underline ml-2",title:"Copy student ID"},"Copy")]),t("div",ae,[t("p",le,u(o.user.phone_number||"No phone number"),1),f("",!0)])]),x(t("div",ie,[t("p",ne,"Full name: "+u(o.user.fullname),1),t("p",de,"Student ID: "+u(o.user.studentid),1),t("p",ue,"Phone: "+u(o.user.phone_number||"No phone number"),1)],512),[[N,r.showProfileDetails]]),t("button",{onClick:e[4]||(e[4]=(...s)=>o.openProfileModal&&o.openProfileModal(...s)),class:"block w-full text-left px-4 py-2 text-gray-800 hover:bg-gray-100 transition-all duration-200"},e[49]||(e[49]=[t("i",{class:"fas fa-user-circle mr-2 text-lg"},null,-1),h(" Edit Profile ")])),B(c,{href:a.route("logout"),method:"post",as:"button",class:"block w-full text-left px-4 py-2 text-gray-800 hover:bg-gray-100 transition-all duration-200"},{default:F(()=>e[50]||(e[50]=[t("i",{class:"fas fa-sign-out-alt mr-2 text-lg"},null,-1),h(" Logout ")])),_:1},8,["href"])],512)):f("",!0)])]),t("div",ce,[t("button",{onClick:e[5]||(e[5]=(...s)=>o.toggleSidebar&&o.toggleSidebar(...s)),type:"button",class:"ml-2 mt-2 p-2 rounded-full bg-[#081c2d] text-white shadow hover:bg-[#00509e] focus:outline-none transition-all duration-200"},e[52]||(e[52]=[t("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M4 6h16M4 12h16M4 18h16"})],-1)])),t("button",{onClick:e[6]||(e[6]=(...s)=>o.openNotificationModal&&o.openNotificationModal(...s)),type:"button",class:"mt-2 p-2 rounded-full bg-[#081c2d] text-white shadow hover:bg-[#00509e] focus:outline-none transition-all duration-200 relative"},[e[53]||(e[53]=t("svg",{class:"w-8 h-8",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M15 17h5l-1.405-1.405A2.032 2.032 0 0118 14.158V11a6.002 6.002 0 00-4-5.659V5a2 2 0 10-4 0v.341C7.67 6.165 6 8.388 6 11v3.159c0 .538-.214 1.055-.595 1.436L4 17h5m6 0v1a3 3 0 11-6 0v-1m6 0H9"})],-1)),o.unreadNotificationsCount>0?(d(),n("span",fe,u(o.unreadNotificationsCount),1)):f("",!0)])]),B(P,{name:"slide"},{default:F(()=>[r.showSidebar?(d(),n("div",ge,[t("div",me,[t("div",he,[t("button",{onClick:e[7]||(e[7]=(...s)=>o.toggleSidebar&&o.toggleSidebar(...s)),type:"button",class:"text-white focus:outline-none"},e[54]||(e[54]=[t("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M6 18L18 6M6 6l12 12"})],-1)]))]),t("nav",pe,[t("div",be,[e[57]||(e[57]=t("span",{class:"text-gray-300 uppercase text-xs tracking-wider"},"Notifications",-1)),t("button",{onClick:e[8]||(e[8]=(...s)=>o.openNotificationModal&&o.openNotificationModal(...s)),type:"button",class:"flex items-center mt-2 text-white hover:text-blue-400 focus:outline-none relative"},[e[55]||(e[55]=t("i",{class:"fas fa-bell mr-2"},null,-1)),e[56]||(e[56]=t("span",null,"Notification",-1)),o.unreadNotificationsCount>0?(d(),n("span",xe,u(o.unreadNotificationsCount),1)):f("",!0)])]),t("div",ve,[e[59]||(e[59]=t("span",{class:"text-gray-300 uppercase text-xs tracking-wider"},"Scanner",-1)),t("button",{onClick:e[9]||(e[9]=(...s)=>o.openScannerModal&&o.openScannerModal(...s)),type:"button",class:"flex items-center mt-2 text-white hover:text-blue-400 focus:outline-none"},e[58]||(e[58]=[t("i",{class:"fas fa-qrcode mr-2"},null,-1),h(" Scan Code ")]))]),t("div",we,[e[61]||(e[61]=t("span",{class:"text-gray-300 uppercase text-xs tracking-wider"},"History",-1)),t("button",{onClick:e[10]||(e[10]=(...s)=>o.openTransactionModal&&o.openTransactionModal(...s)),type:"button",class:"flex items-center mt-2 text-white hover:text-blue-400 focus:outline-none"},e[60]||(e[60]=[t("i",{class:"fas fa-history mr-2"},null,-1),h(" Transaction History ")]))])])]),t("div",{class:"flex-1",onClick:e[11]||(e[11]=(...s)=>o.toggleSidebar&&o.toggleSidebar(...s))})])):f("",!0)]),_:1}),r.isNotificationModalOpen?(d(),n("div",{key:0,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[14]||(e[14]=b((...s)=>o.closeNotificationModal&&o.closeNotificationModal(...s),["self"]))},[t("div",ye,[t("div",ke,[e[62]||(e[62]=t("h3",{class:"text-lg font-semibold text-gray-800"},"Notifications",-1)),l.notifications&&l.notifications.length>0?(d(),n("button",{key:0,onClick:e[12]||(e[12]=(...s)=>o.markAllAsRead&&o.markAllAsRead(...s)),type:"button",class:"text-xs text-blue-600 hover:text-blue-800 font-medium"}," Mark all as read ")):f("",!0)]),t("div",Me,[l.notifications&&l.notifications.length===0?(d(),n("div",Ce,e[63]||(e[63]=[t("i",{class:"fas fa-bell-slash text-4xl text-gray-300 mb-3"},null,-1),t("p",{class:"text-gray-500"},"No notifications yet.",-1)]))):(d(),n("div",De,[t("ul",Se,[(d(!0),n(S,null,q(l.notifications,s=>(d(),n("li",{key:s.id,class:m(["p-3 rounded-lg relative group transition-all duration-200",s.read?"bg-gray-50":"bg-blue-50 border border-blue-200"])},[s.read?f("",!0):(d(),n("div",Te)),t("div",{class:m(s.read?"ml-0":"ml-4")},[t("div",Re,[t("div",qe,[t("p",Be,u(o.buildNotificationText(s,"short")),1),t("p",Fe,u(o.buildNotificationText(s,"long")),1),s.created_at?(d(),n("p",Qe,[e[64]||(e[64]=t("i",{class:"fas fa-clock mr-1"},null,-1)),h(" "+u(o.formatDateTime(s.created_at)),1)])):f("",!0)]),t("div",je,[t("button",{onClick:b(g=>o.toggleReadStatus(s),["stop"]),type:"button",title:s.read?"Mark as unread":"Mark as read",class:"p-1.5 rounded-full hover:bg-gray-200 transition-colors"},[t("i",{class:m(["text-sm",s.read?"fas fa-envelope text-gray-600":"fas fa-envelope-open text-blue-600"])},null,2)],8,Ae),t("button",{onClick:b(g=>o.deleteNotification(s.id),["stop"]),type:"button",title:"Delete notification",class:"p-1.5 rounded-full hover:bg-red-100 transition-colors"},e[65]||(e[65]=[t("i",{class:"fas fa-trash text-sm text-red-600"},null,-1)]),8,Ie)])]),s.read?(d(),n("div",_e,e[66]||(e[66]=[t("span",{class:"text-xs text-gray-400 flex items-center"},[t("i",{class:"fas fa-check-double mr-1"}),h(" Read ")],-1)]))):f("",!0)],2)],2))),128))])]))]),t("button",{onClick:e[13]||(e[13]=(...s)=>o.closeNotificationModal&&o.closeNotificationModal(...s)),type:"button",class:"absolute top-2 right-2 text-gray-400 hover:text-gray-700"},e[67]||(e[67]=[t("i",{class:"fas fa-times"},null,-1)]))])])):f("",!0),r.isTransactionModalOpen?(d(),n("div",{key:1,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[16]||(e[16]=b((...s)=>o.closeTransactionModal&&o.closeTransactionModal(...s),["self"]))},[t("div",Ne,[e[70]||(e[70]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Transaction History",-1)),l.myRequests.length===0?(d(),n("div",Pe,"No transaction history yet.")):(d(),n("div",Oe,[t("table",Le,[e[68]||(e[68]=t("thead",null,[t("tr",null,[t("th",{class:"py-2 px-2 text-left"},"Book"),t("th",{class:"py-2 px-2 text-left"},"Type"),t("th",{class:"py-2 px-2 text-left"},"Start"),t("th",{class:"py-2 px-2 text-left"},"Status")])],-1)),t("tbody",null,[(d(!0),n(S,null,q(l.myRequests,s=>(d(),n("tr",{key:s.id,class:"odd:bg-gray-50 even:bg-white"},[t("td",Ue,u(s.book_title),1),t("td",Ee,u(s.request_type),1),t("td",Ve,u(o.formatDate(s.request_date)),1),t("td",He,[t("span",{class:m({"text-yellow-600":s.status==="pending","text-green-600":s.status==="approved","text-red-600":s.status==="rejected"})},u(s.status),3)])]))),128))])])])),t("button",{onClick:e[15]||(e[15]=(...s)=>o.closeTransactionModal&&o.closeTransactionModal(...s)),type:"button",class:"absolute top-2 right-2 text-gray-400 hover:text-gray-700"},e[69]||(e[69]=[t("i",{class:"fas fa-times"},null,-1)]))])])):f("",!0),r.isBorrowedModalOpen?(d(),n("div",{key:2,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[18]||(e[18]=b((...s)=>o.closeBorrowedModal&&o.closeBorrowedModal(...s),["self"]))},[t("div",ze,[e[72]||(e[72]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Borrowed/Reserve Book",-1)),e[73]||(e[73]=t("div",{class:"text-gray-600"},"No borrowed or reserved books yet.",-1)),t("button",{onClick:e[17]||(e[17]=(...s)=>o.closeBorrowedModal&&o.closeBorrowedModal(...s)),type:"button",class:"absolute top-2 right-2 text-gray-400 hover:text-gray-700"},e[71]||(e[71]=[t("i",{class:"fas fa-times"},null,-1)]))])])):f("",!0),t("main",Ye,[e[88]||(e[88]=t("h1",{class:"text-2xl font-semibold mb-6"},"Available Books",-1)),t("div",Ge,[e[82]||(e[82]=t("h3",{class:"text-sm font-semibold text-gray-700 mb-3 flex items-center"},[t("i",{class:"fas fa-filter mr-2 text-blue-500"}),h(" ðŸ“š Book Age Color Guide: ")],-1)),t("div",We,[t("div",Ze,[e[75]||(e[75]=t("label",{class:"text-sm font-medium text-gray-700 whitespace-nowrap"},[t("i",{class:"fas fa-sort mr-1"}),h(" Sort By: ")],-1)),x(t("select",{"onUpdate:modelValue":e[19]||(e[19]=s=>r.sortBy=s),class:"flex-1 sm:flex-none px-3 sm:px-4 py-2 sm:py-3 bg-gray-100 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 text-gray-700 text-sm sm:min-w-[200px]"},e[74]||(e[74]=[D('<option value="title-asc" data-v-a76f4753>Title (A-Z)</option><option value="title-desc" data-v-a76f4753>Title (Z-A)</option><option value="author-asc" data-v-a76f4753>Author (A-Z)</option><option value="author-desc" data-v-a76f4753>Author (Z-A)</option><option value="course-asc" data-v-a76f4753>Course (A-Z)</option><option value="course-desc" data-v-a76f4753>Course (Z-A)</option><option value="availability" data-v-a76f4753>Availability</option><option value="age-newest" data-v-a76f4753>Book Age (Newest)</option><option value="age-oldest" data-v-a76f4753>Book Age (Oldest)</option>',9)]),512),[[Q,r.sortBy]])]),t("button",{type:"button",onClick:e[20]||(e[20]=s=>o.toggleAgeFilter("new")),class:m(["flex items-center space-x-2 px-3 py-2 rounded-lg transition-all",r.ageFilter==="new"?"bg-green-100 ring-2 ring-green-500":"hover:bg-gray-100"])},e[76]||(e[76]=[t("div",{class:"w-6 h-6 border-4 border-green-500 rounded flex-shrink-0"},null,-1),t("span",{class:"text-gray-700"},"0-2 years (New)",-1)]),2),t("button",{type:"button",onClick:e[21]||(e[21]=s=>o.toggleAgeFilter("recent")),class:m(["flex items-center space-x-2 px-3 py-2 rounded-lg transition-all",r.ageFilter==="recent"?"bg-blue-100 ring-2 ring-blue-500":"hover:bg-gray-100"])},e[77]||(e[77]=[t("div",{class:"w-6 h-6 border-4 border-blue-500 rounded flex-shrink-0"},null,-1),t("span",{class:"text-gray-700"},"3-4 years",-1)]),2),t("button",{type:"button",onClick:e[22]||(e[22]=s=>o.toggleAgeFilter("moderate")),class:m(["flex items-center space-x-2 px-3 py-2 rounded-lg transition-all",r.ageFilter==="moderate"?"bg-yellow-100 ring-2 ring-yellow-500":"hover:bg-gray-100"])},e[78]||(e[78]=[t("div",{class:"w-6 h-6 border-4 border-yellow-500 rounded flex-shrink-0"},null,-1),t("span",{class:"text-gray-700"},"5-6 years",-1)]),2),t("button",{type:"button",onClick:e[23]||(e[23]=s=>o.toggleAgeFilter("older")),class:m(["flex items-center space-x-2 px-3 py-2 rounded-lg transition-all",r.ageFilter==="older"?"bg-orange-100 ring-2 ring-orange-500":"hover:bg-gray-100"])},e[79]||(e[79]=[t("div",{class:"w-6 h-6 border-4 border-orange-500 rounded flex-shrink-0"},null,-1),t("span",{class:"text-gray-700"},"7-9 years",-1)]),2),t("button",{type:"button",onClick:e[24]||(e[24]=s=>o.toggleAgeFilter("old")),class:m(["flex items-center space-x-2 px-3 py-2 rounded-lg transition-all",r.ageFilter==="old"?"bg-red-100 ring-2 ring-red-500":"hover:bg-gray-100"])},e[80]||(e[80]=[t("div",{class:"w-6 h-6 border-4 border-red-500 rounded flex-shrink-0"},null,-1),t("span",{class:"text-gray-700"},"10+ years (Old)",-1)]),2),r.ageFilter?(d(),n("button",{key:0,type:"button",onClick:e[25]||(e[25]=(...s)=>o.clearAgeFilter&&o.clearAgeFilter(...s)),class:"flex items-center space-x-2 px-3 py-2 rounded-lg bg-gray-200 hover:bg-gray-300 transition-all"},e[81]||(e[81]=[t("i",{class:"fas fa-times"},null,-1),t("span",{class:"text-gray-700 font-semibold"},"Clear Filter",-1)]))):f("",!0)])]),t("div",Ke,[(d(!0),n(S,null,q(o.filteredBooks,s=>(d(),n("div",{key:s.id,onClick:g=>o.openModal(s),class:m(["bg-white shadow-md rounded-lg overflow-hidden cursor-pointer hover:scale-105 transition transform border-2 md:border-4",o.getBookAgeBorderClass(s)])},[t("div",Xe,[t("img",{src:s.image_url||"/img/default-book.jpg",alt:"Book Cover",loading:"lazy",class:"w-full h-full object-cover block"},null,8,$e)]),t("div",et,[t("h6",{title:s.title,class:"text-xl font-extrabold text-gray-900 leading-tight mb-1 line-clamp-2"},u(s.title),9,tt),t("button",{onClick:b(g=>o.viewQrCode(s.id,s.title),["stop"]),type:"button",class:"mt-2 inline-flex items-center px-3 py-1 bg-gray-100 text-sm text-gray-700 rounded-md hover:bg-gray-200 focus:outline-none"},e[83]||(e[83]=[t("i",{class:"fas fa-qrcode mr-2"},null,-1),h(" View QR Code ")]),8,st),t("p",ot,u(s.description),1),t("p",rt,[e[84]||(e[84]=t("span",{class:"font-semibold"},"Course:",-1)),e[85]||(e[85]=h()),t("span",at,u(s.course||"N/A"),1)]),t("p",lt,[e[86]||(e[86]=t("span",{class:"font-semibold"},"Author:",-1)),e[87]||(e[87]=h()),t("span",it,u(s.author),1)]),t("span",{class:m([{"text-green-600 font-medium":s.availability==="Available","text-red-600 font-medium":s.availability==="Borrowed","text-yellow-600 font-medium":s.availability==="Reserved"},"block mt-2"])},u(s.availability),3)])],10,Je))),128))])]),r.isModalOpen?(d(),n("div",{key:3,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[32]||(e[32]=b((...s)=>o.closeModal&&o.closeModal(...s),["self"]))},[t("div",nt,[t("h3",dt,[e[89]||(e[89]=h("Request Book ")),r.selectedBook?(d(),n("span",ut,"- "+u(r.selectedBook.title),1)):f("",!0)]),t("form",{onSubmit:e[31]||(e[31]=b((...s)=>o.submitRequest&&o.submitRequest(...s),["prevent"])),class:"space-y-4"},[t("div",null,[e[91]||(e[91]=t("label",{for:"requestType",class:"block text-sm font-medium text-gray-700"},"Request Type:",-1)),x(t("select",{id:"requestType",name:"requestType","onUpdate:modelValue":e[26]||(e[26]=s=>r.requestType=s),class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},e[90]||(e[90]=[t("option",{value:""},"Select a request type",-1),t("option",{value:"borrow"},"Borrow",-1),t("option",{value:"reserve"},"Reserve",-1)]),512),[[Q,r.requestType]])]),t("div",null,[e[92]||(e[92]=t("label",{for:"startDate",class:"block text-sm font-medium text-gray-700"},"Start Date:",-1)),x(t("input",{id:"startDate",name:"startDate",type:"date","onUpdate:modelValue":e[27]||(e[27]=s=>r.startDate=s),onChange:e[28]||(e[28]=(...s)=>o.onStartDateChange&&o.onStartDateChange(...s)),autocomplete:"off",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",min:new Date().toISOString().split("T")[0],required:""},null,40,ct),[[C,r.startDate]])]),t("div",null,[t("label",ft,u(r.requestType==="borrow"?"Return Date":"Until Date")+": ",1),x(t("input",{id:"returnDate",name:"returnDate",type:"date","onUpdate:modelValue":e[29]||(e[29]=s=>r.returnDate=s),autocomplete:"off",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",min:o.returnDateMin,required:""},null,8,gt),[[C,r.returnDate]])]),t("div",mt,[t("button",{type:"button",onClick:e[30]||(e[30]=(...s)=>o.closeModal&&o.closeModal(...s)),class:"px-4 py-2 text-black-600 hover:bg-black-100 rounded-lg"}," Cancel "),t("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600 disabled:opacity-50 disabled:cursor-not-allowed",disabled:!r.requestType||!r.startDate||!r.returnDate}," Submit Request ",8,ht)])],32)])])):f("",!0),r.isProfileModalOpen?(d(),n("div",{key:4,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[38]||(e[38]=b((...s)=>o.closeProfileModal&&o.closeProfileModal(...s),["self"]))},[t("div",pt,[e[97]||(e[97]=t("h3",{class:"text-lg font-semibold text-gray-800 mb-4"},"Edit Profile",-1)),t("form",{onSubmit:e[37]||(e[37]=b((...s)=>o.updateProfile&&o.updateProfile(...s),["prevent"])),class:"space-y-4"},[t("div",null,[e[93]||(e[93]=t("label",{for:"profileFullname",class:"block text-sm font-medium text-gray-700"},"Full Name:",-1)),x(t("input",{id:"profileFullname",name:"fullname",type:"text","onUpdate:modelValue":e[33]||(e[33]=s=>r.profileForm.fullname=s),autocomplete:"name",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},null,512),[[C,r.profileForm.fullname]])]),t("div",null,[e[94]||(e[94]=t("label",{for:"profileEmail",class:"block text-sm font-medium text-gray-700"},"Email:",-1)),x(t("input",{id:"profileEmail",name:"email",type:"email","onUpdate:modelValue":e[34]||(e[34]=s=>r.profileForm.email=s),autocomplete:"email",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400",required:""},null,512),[[C,r.profileForm.email]])]),t("div",null,[e[95]||(e[95]=t("label",{for:"profilePhone",class:"block text-sm font-medium text-gray-700"},"Phone Number:",-1)),x(t("input",{id:"profilePhone",name:"phone_number",type:"tel","onUpdate:modelValue":e[35]||(e[35]=s=>r.profileForm.phone_number=s),autocomplete:"tel",class:"w-full p-3 border border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-400"},null,512),[[C,r.profileForm.phone_number]])]),t("div",bt,[t("button",{type:"button",onClick:e[36]||(e[36]=(...s)=>o.closeProfileModal&&o.closeProfileModal(...s)),class:"px-4 py-2 text-gray-600 hover:bg-gray-100 rounded-lg"}," Cancel "),e[96]||(e[96]=t("button",{type:"submit",class:"px-4 py-2 bg-blue-500 text-white rounded-lg hover:bg-blue-600"}," Save Changes ",-1))])],32)])])):f("",!0),r.showQrModal?(d(),n("div",{key:5,class:"fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center z-50 p-2 sm:p-4",onClick:e[41]||(e[41]=b(s=>r.showQrModal=!1,["self"]))},[t("div",xt,[t("h3",vt,"QR Code - "+u(r.qrModalBookTitle),1),r.qrModalSvg&&r.qrModalSvg.length>0?(d(),n("div",{key:0,class:"flex justify-center mb-4",innerHTML:r.qrModalSvg},null,8,wt)):(d(),n("div",yt,e[98]||(e[98]=[t("div",{class:"text-center"},[t("div",{class:"inline-block animate-spin rounded-full h-8 w-8 border-b-2 border-blue-500 mb-2"}),t("p",{class:"text-gray-500 text-sm"},"Loading QR code...")],-1)]))),t("div",kt,[t("button",{onClick:e[39]||(e[39]=(...s)=>o.downloadQr&&o.downloadQr(...s)),type:"button",disabled:!r.qrModalSvg,class:"px-4 py-2 bg-green-500 text-white rounded-lg hover:bg-green-600 disabled:opacity-50 disabled:cursor-not-allowed"},"Download PNG",8,Mt),t("button",{onClick:e[40]||(e[40]=s=>r.showQrModal=!1),type:"button",class:"px-4 py-2 bg-gray-200 text-gray-800 rounded-lg hover:bg-gray-300"},"Close")])])])):f("",!0),r.showScannerModal?(d(),n("div",Ct,[t("div",Dt,[t("div",St,[e[100]||(e[100]=D('<div class="flex items-center space-x-3" data-v-a76f4753><div class="w-10 h-10 bg-white/20 rounded-full flex items-center justify-center backdrop-blur-sm" data-v-a76f4753><i class="fas fa-qrcode text-white text-lg" data-v-a76f4753></i></div><div data-v-a76f4753><h3 class="text-xl font-bold text-white" data-v-a76f4753>QR Code Scanner</h3><p class="text-xs text-blue-100" data-v-a76f4753>Scan or upload a QR code to find books</p></div></div>',1)),t("button",{onClick:e[42]||(e[42]=(...s)=>o.closeScannerModal&&o.closeScannerModal(...s)),type:"button",class:"w-10 h-10 rounded-full bg-white/10 hover:bg-white/20 backdrop-blur-sm flex items-center justify-center transition-all duration-200 group","aria-label":"Close scanner"},e[99]||(e[99]=[t("i",{class:"fas fa-times text-white group-hover:scale-110 transition-transform"},null,-1)]))]),t("div",Tt,[t("div",Rt,[t("div",qt,[t("div",Bt,[t("video",{id:"scannerVideo",ref:"scanVideo",playsinline:"",muted:"",class:m(["w-full h-72 md:h-96 object-cover",r.scannerActive?"ring-4 ring-green-400":""]),"aria-label":"QR Code Scanner Camera"},null,2),r.scannerActive?(d(),n("div",Ft,e[101]||(e[101]=[D('<div class="absolute top-4 left-4 w-12 h-12 border-t-4 border-l-4 border-green-400 rounded-tl-lg" data-v-a76f4753></div><div class="absolute top-4 right-4 w-12 h-12 border-t-4 border-r-4 border-green-400 rounded-tr-lg" data-v-a76f4753></div><div class="absolute bottom-4 left-4 w-12 h-12 border-b-4 border-l-4 border-green-400 rounded-bl-lg" data-v-a76f4753></div><div class="absolute bottom-4 right-4 w-12 h-12 border-b-4 border-r-4 border-green-400 rounded-br-lg" data-v-a76f4753></div><div class="absolute inset-x-8 top-1/2 h-0.5 bg-gradient-to-r from-transparent via-green-400 to-transparent animate-scan" data-v-a76f4753></div>',5)]))):f("",!0),t("div",Qt,[r.scannerActive?(d(),n("div",jt,e[102]||(e[102]=[t("div",{class:"w-2 h-2 bg-white rounded-full animate-ping"},null,-1),t("span",{class:"text-sm font-semibold"},"ðŸ“· Scanning Active",-1)]))):(d(),n("div",At,e[103]||(e[103]=[t("span",{class:"text-sm font-semibold"},"Camera Ready",-1)])))]),t("canvas",It,null,512)]),t("div",_t,[t("div",Nt,[e[105]||(e[105]=t("div",{class:"w-10 h-10 bg-blue-100 rounded-full flex items-center justify-center"},[t("i",{class:"fas fa-camera text-blue-600"})],-1)),t("div",null,[e[104]||(e[104]=t("p",{class:"text-sm font-semibold text-gray-800"},"Camera Mode",-1)),t("p",Pt,u(r.facingMode==="environment"?"Back Camera":"Front Camera"),1)])]),t("button",{onClick:e[43]||(e[43]=(...s)=>o.toggleFacing&&o.toggleFacing(...s)),type:"button",class:"px-4 py-2 bg-gradient-to-r from-blue-500 to-teal-500 text-white rounded-lg hover:from-blue-600 hover:to-teal-600 transition-all duration-200 shadow-md hover:shadow-lg flex items-center space-x-2 font-semibold"},e[106]||(e[106]=[t("i",{class:"fas fa-sync-alt"},null,-1),t("span",null,"Flip Camera",-1)]))])]),t("div",Ot,[t("div",Lt,[e[108]||(e[108]=D('<div class="flex items-center space-x-3 mb-4" data-v-a76f4753><div class="w-10 h-10 bg-blue-500 rounded-full flex items-center justify-center" data-v-a76f4753><i class="fas fa-cloud-upload-alt text-white" data-v-a76f4753></i></div><div data-v-a76f4753><h4 class="text-sm font-bold text-gray-800" data-v-a76f4753>Upload QR Code</h4><p class="text-xs text-gray-600" data-v-a76f4753>Or choose an image file</p></div></div>',1)),t("input",{id:"qrUploadInput",name:"qrUpload",type:"file",ref:"qrFileInput",onChange:e[44]||(e[44]=(...s)=>o.previewUploadedQr&&o.previewUploadedQr(...s)),accept:"image/*",autocomplete:"off","aria-label":"Upload QR Code Image",class:"hidden"},null,544),e[109]||(e[109]=t("label",{for:"qrUploadInput",class:"block w-full py-3 px-4 bg-gradient-to-r from-blue-500 to-teal-500 text-white text-center rounded-lg cursor-pointer hover:from-blue-600 hover:to-teal-600 transition-all duration-200 shadow-md hover:shadow-lg font-semibold"},[t("i",{class:"fas fa-folder-open mr-2"}),h(" Choose Image File ")],-1)),r.uploadedQrPreview?(d(),n("div",Ut,[t("div",Et,[t("img",{src:r.uploadedQrPreview,class:"w-full h-40 object-contain rounded",alt:"QR Preview"},null,8,Vt)]),t("button",{onClick:e[45]||(e[45]=(...s)=>o.scanUploadedQr&&o.scanUploadedQr(...s)),type:"button",class:"w-full mt-3 py-3 px-4 bg-gradient-to-r from-green-500 to-emerald-500 text-white rounded-lg hover:from-green-600 hover:to-emerald-600 transition-all duration-200 shadow-md hover:shadow-lg font-semibold flex items-center justify-center space-x-2"},e[107]||(e[107]=[t("i",{class:"fas fa-search"},null,-1),t("span",null,"Scan This QR Code",-1)]))])):f("",!0),e[110]||(e[110]=t("p",{class:"text-xs text-gray-500 mt-3 flex items-start space-x-2"},[t("i",{class:"fas fa-info-circle mt-0.5"}),t("span",null,"Upload a screenshot or photo of a QR code from your device")],-1))]),t("div",Ht,[e[111]||(e[111]=t("div",{class:"flex items-center space-x-3 mb-3"},[t("div",{class:"w-10 h-10 bg-purple-100 rounded-full flex items-center justify-center"},[t("i",{class:"fas fa-history text-purple-600"})]),t("h4",{class:"text-sm font-bold text-gray-800"},"Last Scanned")],-1)),t("div",zt,[r.scannedCode?(d(),n("p",Yt,u(r.scannedCode),1)):(d(),n("p",Gt,"No code scanned yet"))])]),e[113]||(e[113]=D('<div class="bg-gradient-to-br from-amber-50 to-orange-50 rounded-xl p-5 border border-amber-200 shadow-md" data-v-a76f4753><div class="flex items-start space-x-3" data-v-a76f4753><div class="w-8 h-8 bg-amber-500 rounded-full flex items-center justify-center flex-shrink-0 mt-0.5" data-v-a76f4753><i class="fas fa-lightbulb text-white text-sm" data-v-a76f4753></i></div><div data-v-a76f4753><h4 class="text-sm font-bold text-gray-800 mb-2" data-v-a76f4753>How to Scan</h4><ul class="text-xs text-gray-600 space-y-1.5" data-v-a76f4753><li class="flex items-start space-x-2" data-v-a76f4753><i class="fas fa-check text-green-500 mt-0.5" data-v-a76f4753></i><span data-v-a76f4753>Point camera at QR code</span></li><li class="flex items-start space-x-2" data-v-a76f4753><i class="fas fa-check text-green-500 mt-0.5" data-v-a76f4753></i><span data-v-a76f4753>Hold steady for auto-scan</span></li><li class="flex items-start space-x-2" data-v-a76f4753><i class="fas fa-check text-green-500 mt-0.5" data-v-a76f4753></i><span data-v-a76f4753>Or upload an image file</span></li></ul></div></div></div>',1)),t("button",{onClick:e[46]||(e[46]=(...s)=>o.closeScannerModal&&o.closeScannerModal(...s)),type:"button",class:"w-full px-4 py-3 bg-gradient-to-r from-gray-600 to-gray-700 text-white rounded-lg hover:from-gray-700 hover:to-gray-800 transition-all duration-200 shadow-md hover:shadow-lg font-semibold flex items-center justify-center space-x-2"},e[112]||(e[112]=[t("i",{class:"fas fa-check-circle"},null,-1),t("span",null,"Done Scanning",-1)]))])])])])])):f("",!0),r.showToast?(d(),n("div",Wt,u(r.toastMessage),1)):f("",!0)],64)}const $t=L(V,[["render",Zt],["__scopeId","data-v-a76f4753"]]);export{$t as default};
