import{i as f,r as w,c as k,w as B,o as a,b as e,h,v as x,f as n,q as p,n as m,d as g,t as o,F as u,g as c,l as D,e as C}from"./app-BP0YNKCv.js";import{L as R}from"./FrontEndLayout-CGp3JsNY.js";import{_ as q}from"./Modal-D2JsVKOX.js";import{_ as A}from"./_plugin-vue_export-helper-DlAUqK2U.js";const M={components:{Link:f,Layout:R,Modal:q},props:{books:Array,bookRequests:Array},data(){return{activeTab:"books",searchQuery:"",showModal:!1,editBookData:{id:null,title:"",author:"",course:"",availability:"Available",availabilityDate:"",image_url:null},tabs:[{label:"All Books",value:"books"},{label:"Requests",value:"requests"},{label:"Borrowed",value:"borrowed"},{label:"Reserved",value:"reserved"}],requestForm:{type:"borrow",request_date:"",return_date:"",book_id:null}}},computed:{filteredBooks(){return this.books.filter(l=>l.title.toLowerCase().includes(this.searchQuery.toLowerCase())||l.author.toLowerCase().includes(this.searchQuery.toLowerCase())||l.course&&l.course.toLowerCase().includes(this.searchQuery.toLowerCase()))},borrowedBooks(){return this.books.filter(l=>l.availability==="Borrowed")},reservedBooks(){return this.books.filter(l=>l.availability==="Reserved")},pendingRequests(){return this.bookRequests.filter(l=>l.status==="pending")},historyRequests(){return this.bookRequests.filter(l=>l.status==="rejected"||l.status==="approved")}},methods:{getStatusClass(l){return{Available:"bg-green-100 text-green-800",Borrowed:"bg-red-100 text-red-800",Reserved:"bg-yellow-100 text-yellow-800"}[l]||"bg-gray-100 text-gray-800"},getTabCount(l){switch(l){case"books":return this.books.length;case"borrowed":return this.books.filter(s=>s.availability==="Borrowed").length;case"reserved":return this.books.filter(s=>s.availability==="Reserved").length;case"requests":return this.bookRequests.length}},async approveRequest(l){try{await this.$inertia.patch(route("book-requests.approve",l))}catch{alert("Error approving request")}},async rejectRequest(l){try{await this.$inertia.patch(route("book-requests.reject",l))}catch{alert("Error rejecting request")}},returnBook(l){this.$inertia.post(route("receipts.return",l),{action_type:"return",return_date:new Date().toISOString()})},cancelReservation(l){this.$inertia.delete(route("reserve.destroy",l),{data:{action_type:"cancellation",cancellation_date:new Date().toISOString()}})},formatDate(l){return l?new Date(l).toLocaleDateString():""},updateBook(l){this.editBookData={id:l.id,title:l.title,author:l.author,course:l.course||"",availability:l.availability||"Available",availabilityDate:l.availabilityDate||"",image_url:l.image_url},this.showModal=!0},saveBook(){const l=new FormData;l.append("_method","PUT"),l.append("title",this.editBookData.title),l.append("author",this.editBookData.author),l.append("course",this.editBookData.course),l.append("availability",this.editBookData.availability),this.editBookData.image_url instanceof File&&l.append("image",this.editBookData.image_url),this.$inertia.post(route("books.update",this.editBookData.id),l,{preserveScroll:!0,onSuccess:()=>{this.closeModal()}})},handleImageUpload(l){const s=l.target.files[0];s&&(this.editBookData.image_url=s)},closeModal(){this.showModal=!1,this.editBookData={id:null,title:"",author:"",course:"",availability:"Available",availabilityDate:"",image_url:null}},showRequestModal(l){this.requestForm.book_id=l.id,this.showRequestModal=!0},closeRequestModal(){this.requestForm={type:"borrow",request_date:"",return_date:"",book_id:null},this.showRequestModal=!1},submitRequest(){this.$inertia.post(route("book-requests.store"),this.requestForm),this.closeRequestModal()}}},S={class:"ml-64 p-8 flex-1 bg-gradient-to-br from-gray-50 to-gray-200 min-h-screen"},T={class:"p-6 bg-white shadow rounded-lg"},j={class:"flex items-center bg-gray-100 p-4 rounded-lg shadow-inner mb-6"},L={class:"mb-6 flex space-x-4"},U=["onClick"],F={class:"ml-2 bg-white text-blue-500 rounded-full px-2 py-1 text-xs"},I={key:0,class:"min-w-full"},N={class:"px-4 py-2"},V=["src"],E={class:"px-4 py-2"},Q={class:"text-gray-700 font-medium"},P={class:"px-4 py-2"},z={class:"px-4 py-2"},O={class:"text-gray-600"},H={class:"px-4 py-2"},G={class:"px-4 py-2"},J={class:"flex flex-col"},K={key:0,class:"text-sm text-gray-600"},W={key:1,class:"text-sm text-gray-600"},X={class:"px-4 py-2 flex justify-center space-x-2"},Y=["onClick"],Z=["onClick"],$={key:1,class:"min-w-full"},ee={class:"px-4 py-2"},te={class:"px-4 py-2"},se={class:"px-4 py-2"},le={class:"px-4 py-2"},oe={class:"px-4 py-2"},re=["onClick"],ae={key:2,class:"min-w-full"},ie={class:"px-4 py-2"},ne={class:"px-4 py-2"},de={class:"px-4 py-2"},ue={class:"px-4 py-2"},ce={class:"px-4 py-2"},pe=["onClick"],ye={class:"min-w-full mb-8"},be={class:"px-4 py-2"},he={class:"px-4 py-2"},ge={class:"px-4 py-2 capitalize"},xe={class:"px-4 py-2"},me={class:"px-4 py-2"},_e={class:"px-4 py-2"},ve={class:"px-4 py-2 space-x-2"},fe=["onClick"],we=["onClick"],ke={class:"min-w-full"},Be={class:"px-4 py-2"},De={class:"px-4 py-2"},Ce={class:"px-4 py-2"},Re={class:"px-4 py-2"},qe={class:"px-4 py-2"},Ae={class:"bg-white p-6 rounded-lg shadow-lg w-full max-w-md"},Me={class:"mb-4"},Se={class:"mb-4"},Te={class:"mb-4"},je={class:"mb-4"},Le={class:"mb-4"},Ue=["src"],Fe={class:"mb-4"},Ie={class:"flex justify-between mt-6 space-x-4"};function Ne(l,s,Ve,Ee,i,r){const _=w("Layout");return a(),k(_,null,{default:B(()=>[e("div",S,[e("main",T,[e("div",j,[s[9]||(s[9]=e("img",{src:"/img/icon.png",class:"w-6 h-6 mr-3 opacity-70",alt:"Search Icon"},null,-1)),h(e("input",{type:"text","onUpdate:modelValue":s[0]||(s[0]=t=>i.searchQuery=t),placeholder:"Search by title, author, or course...",class:"w-full p-3 bg-transparent text-gray-700 placeholder-gray-500 focus:outline-none focus:ring-2 focus:ring-blue-500 rounded"},null,512),[[x,i.searchQuery]])]),e("div",L,[(a(!0),n(u,null,p(i.tabs,t=>(a(),n("button",{key:t.value,onClick:d=>i.activeTab=t.value,class:m(["px-4 py-2 rounded-lg",i.activeTab===t.value?"bg-blue-500 text-white":"bg-gray-200"])},[g(o(t.label)+" ",1),e("span",F,o(r.getTabCount(t.value)),1)],10,U))),128))]),i.activeTab==="books"?(a(),n("table",I,[s[12]||(s[12]=e("thead",{class:"bg-blue-50 text-gray-600 text-sm uppercase tracking-wider"},[e("tr",null,[e("th",{class:"px-4 py-2 text-left"},"Cover"),e("th",{class:"px-4 py-2 text-left"},"Title"),e("th",{class:"px-4 py-2 text-left"},"Author"),e("th",{class:"px-4 py-2 text-left"},"Course"),e("th",{class:"px-4 py-2 text-left"},"Book ID"),e("th",{class:"px-4 py-2 text-left"},"Availability"),e("th",{class:"px-4 py-2 text-center"},"Actions")])],-1)),e("tbody",null,[(a(!0),n(u,null,p(r.filteredBooks,t=>(a(),n("tr",{key:t.id},[e("td",N,[e("img",{src:t.image_url||"/img/default-book.jpg",alt:"Book Cover",class:"w-full h-20 object-cover"},null,8,V)]),e("td",E,[e("span",Q,o(t.title),1)]),e("td",P,o(t.author),1),e("td",z,[e("span",O,o(t.course||"N/A"),1)]),e("td",H,o(t.bookId),1),e("td",G,[e("div",J,[e("span",{class:m(r.getStatusClass(t.availability))},o(t.availability),3),t.availability==="Borrowed"&&t.current_borrower?(a(),n("span",K,[g(" Borrowed by: "+o(t.current_borrower.fullname)+" ",1),s[10]||(s[10]=e("br",null,null,-1)),g(" Due: "+o(r.formatDate(t.current_borrower.due_date)),1)])):c("",!0),t.availability==="Reserved"&&t.current_reserver?(a(),n("span",W,[g(" Reserved by: "+o(t.current_reserver.fullname)+" ",1),s[11]||(s[11]=e("br",null,null,-1)),g(" Until: "+o(r.formatDate(t.current_reserver.until_date)),1)])):c("",!0)])]),e("td",X,[e("button",{onClick:d=>r.updateBook(t),class:"px-3 py-1 bg-blue-500 text-white rounded hover:bg-blue-600 transition"}," Edit ",8,Y),e("button",{onClick:d=>l.deleteBook(t.id),class:"px-3 py-1 bg-red-500 text-white rounded hover:bg-red-600 transition"}," Delete ",8,Z)])]))),128))])])):c("",!0),i.activeTab==="borrowed"?(a(),n("table",$,[s[13]||(s[13]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Borrower"),e("th",{class:"px-4 py-2"},"Phone Number"),e("th",{class:"px-4 py-2"},"Due Date"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(a(!0),n(u,null,p(r.borrowedBooks,t=>{var d,y,b;return a(),n("tr",{key:t.id},[e("td",ee,o(t.title),1),e("td",te,o((d=t.current_borrower)==null?void 0:d.fullname),1),e("td",se,o(((y=t.current_borrower)==null?void 0:y.phone_number)||"N/A"),1),e("td",le,o(r.formatDate((b=t.current_borrower)==null?void 0:b.due_date)),1),e("td",oe,[e("button",{onClick:v=>r.returnBook(t.id),class:"bg-green-500 text-white px-3 py-1 rounded"}," Return ",8,re)])])}),128))])])):c("",!0),i.activeTab==="reserved"?(a(),n("table",ae,[s[14]||(s[14]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Reserved By"),e("th",{class:"px-4 py-2"},"Phone Number"),e("th",{class:"px-4 py-2"},"Until Date"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(a(!0),n(u,null,p(r.reservedBooks,t=>{var d,y,b;return a(),n("tr",{key:t.id},[e("td",ie,o(t.title),1),e("td",ne,o((d=t.current_reserver)==null?void 0:d.fullname),1),e("td",de,o(((y=t.current_reserver)==null?void 0:y.phone_number)||"N/A"),1),e("td",ue,o(r.formatDate((b=t.current_reserver)==null?void 0:b.until_date)),1),e("td",ce,[e("button",{onClick:v=>r.cancelReservation(t.id),class:"bg-red-500 text-white px-3 py-1 rounded"}," Cancel ",8,pe)])])}),128))])])):c("",!0),i.activeTab==="requests"?(a(),n(u,{key:3},[s[17]||(s[17]=e("h3",{class:"text-lg font-semibold mb-4"},"Pending Requests",-1)),e("table",ye,[s[15]||(s[15]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Requester"),e("th",{class:"px-4 py-2"},"Type"),e("th",{class:"px-4 py-2"},"Start Date"),e("th",{class:"px-4 py-2"},"End Date"),e("th",{class:"px-4 py-2"},"Status"),e("th",{class:"px-4 py-2"},"Actions")])],-1)),e("tbody",null,[(a(!0),n(u,null,p(r.pendingRequests,t=>(a(),n("tr",{key:t.id},[e("td",be,o(t.book.title),1),e("td",he,o(t.user.fullname),1),e("td",ge,o(t.request_type),1),e("td",xe,o(r.formatDate(t.request_date)),1),e("td",me,o(r.formatDate(t.return_date)),1),e("td",_e,[e("span",{class:m({"text-yellow-600":t.status==="pending","text-green-600":t.status==="approved","text-red-600":t.status==="rejected"})},o(t.status),3)]),e("td",ve,[e("button",{onClick:d=>r.approveRequest(t.id),class:"bg-green-500 text-white px-3 py-1 rounded hover:bg-green-600"}," Approve ",8,fe),e("button",{onClick:d=>r.rejectRequest(t.id),class:"bg-red-500 text-white px-3 py-1 rounded hover:bg-red-600"}," Reject ",8,we)])]))),128))])]),s[18]||(s[18]=e("h3",{class:"text-lg font-semibold mb-4 mt-[20vh]"},"History",-1)),e("table",ke,[s[16]||(s[16]=e("thead",{class:"bg-blue-50"},[e("tr",null,[e("th",{class:"px-4 py-2"},"Book"),e("th",{class:"px-4 py-2"},"Requester"),e("th",{class:"px-4 py-2"},"Type"),e("th",{class:"px-4 py-2"},"Date"),e("th",{class:"px-4 py-2"},"Status")])],-1)),e("tbody",null,[(a(!0),n(u,null,p(r.historyRequests,t=>(a(),n("tr",{key:t.id},[e("td",Be,o(t.book.title),1),e("td",De,o(t.user.fullname),1),e("td",Ce,o(t.request_type),1),e("td",Re,o(r.formatDate(t.request_date)),1),e("td",qe,o(t.status),1)]))),128))])])],64)):c("",!0),i.showModal?(a(),n("div",{key:4,class:"fixed inset-0 flex items-center justify-center bg-gray-900 bg-opacity-50 z-50",onClick:s[8]||(s[8]=C((...t)=>r.closeModal&&r.closeModal(...t),["self"]))},[e("div",Ae,[s[26]||(s[26]=e("h3",{class:"text-xl font-semibold text-gray-700 mb-4"},"Edit Book Details",-1)),e("div",Me,[s[19]||(s[19]=e("label",{for:"editTitle",class:"block text-sm font-medium text-gray-600"},"Title:",-1)),h(e("input",{type:"text","onUpdate:modelValue":s[1]||(s[1]=t=>i.editBookData.title=t),id:"editTitle",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,i.editBookData.title]])]),e("div",Se,[s[20]||(s[20]=e("label",{for:"editAuthor",class:"block text-sm font-medium text-gray-600"},"Author:",-1)),h(e("input",{type:"text","onUpdate:modelValue":s[2]||(s[2]=t=>i.editBookData.author=t),id:"editAuthor",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,i.editBookData.author]])]),e("div",Te,[s[21]||(s[21]=e("label",{for:"editCourse",class:"block text-sm font-medium text-gray-600"},"Course:",-1)),h(e("input",{type:"text","onUpdate:modelValue":s[3]||(s[3]=t=>i.editBookData.course=t),id:"editCourse",placeholder:"e.g., Computer Science, Mathematics, Literature",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,512),[[x,i.editBookData.course]])]),e("div",je,[s[23]||(s[23]=e("label",{for:"availabilitySelect",class:"block text-sm font-medium text-gray-600"},"Availability:",-1)),h(e("select",{"onUpdate:modelValue":s[4]||(s[4]=t=>i.editBookData.availability=t),id:"availabilitySelect",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},s[22]||(s[22]=[e("option",{value:"Available"},"Available",-1),e("option",{value:"Borrowed"},"Borrowed",-1),e("option",{value:"Reserved"},"Reserved",-1)]),512),[[D,i.editBookData.availability]])]),e("div",Le,[s[24]||(s[24]=e("label",{class:"block text-sm font-medium text-gray-600"},"Current Cover:",-1)),e("img",{src:i.editBookData.image_url||"/img/default-book.jpg",alt:"Current Book Cover",class:"h-20 object-cover rounded mt-2"},null,8,Ue)]),e("div",Fe,[s[25]||(s[25]=e("label",{for:"imageUpload",class:"block text-sm font-medium text-gray-600"}," Update Book Cover: ",-1)),e("input",{type:"file",id:"imageUpload",onChange:s[5]||(s[5]=(...t)=>r.handleImageUpload&&r.handleImageUpload(...t)),accept:"image/jpeg,image/png,image/jpg",class:"mt-1 p-2 border border-gray-300 rounded w-full focus:outline-none focus:ring-2 focus:ring-blue-500"},null,32)]),e("div",Ie,[e("button",{onClick:s[6]||(s[6]=(...t)=>r.saveBook&&r.saveBook(...t)),class:"px-4 py-2 bg-blue-500 text-white rounded hover:bg-blue-600 transition w-full"}," Save "),e("button",{onClick:s[7]||(s[7]=(...t)=>r.closeModal&&r.closeModal(...t)),class:"px-4 py-2 bg-gray-200 text-gray-700 rounded hover:bg-gray-300 transition w-full"}," Cancel ")])])])):c("",!0)])])]),_:1})}const He=A(M,[["render",Ne]]);export{He as default};
