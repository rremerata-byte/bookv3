import{i as n,e,m as p,t as o,n as d,f as g,p as f,v as y,D as w,k as c,E as k,F as S,z as R,o as i}from"./vendor-D6j6WTf-.js";import{_ as I}from"./_plugin-vue_export-helper-DlAUqK2U.js";const _={name:"GuardDashboard",props:{flash:{type:Object,default:()=>({})},scanResult:{type:Object,default:null}},data(){return{scannerActive:!1,cameraReady:!1,scanning:!1,manualBookId:"",lastScanResult:null,scanHistory:[],scannedToday:0,approvedToday:0,blockedToday:0,uploadedImage:null,processingImage:!1}},methods:{toggleScanner(){this.scannerActive?this.stopScanner():this.startScanner()},async startScanner(){this.scannerActive=!0,this.cameraReady=!1,setTimeout(()=>{this.cameraReady=!0},1500)},stopScanner(){this.scannerActive=!1,this.cameraReady=!1,this.scanning=!1},async scanManualBookId(){var a;if(this.manualBookId.trim()){this.scanning=!0;try{const u=await(await fetch(`/guard/scan/${this.manualBookId}`,{method:"GET",headers:{"Content-Type":"application/json","X-CSRF-TOKEN":this.$page.props.csrf_token||((a=document.querySelector('meta[name="csrf-token"]'))==null?void 0:a.getAttribute("content"))}})).json();this.handleScanResult(u)}catch(t){console.error("Scan error:",t),this.handleScanResult({status:"error",approved:!1,message:"Error scanning book",book:null})}this.manualBookId="",this.scanning=!1}},handleScanResult(a){a.timestamp=new Date,this.lastScanResult=a,this.scanHistory.unshift({...a}),this.scanHistory.length>10&&this.scanHistory.pop(),this.scannedToday++,a.approved?(this.approvedToday++,this.playApprovedSound()):(this.blockedToday++,this.playDeniedSound()),this.saveScanData()},getStatusBadgeClass(a){switch(a){case"Borrowed":return"bg-blue-500/20 text-blue-200";case"Available":return"bg-green-500/20 text-green-200";case"Reserved":return"bg-yellow-500/20 text-yellow-200";case"Pending":return"bg-orange-500/20 text-orange-200";default:return"bg-gray-500/20 text-gray-200"}},formatTime(a){return new Date(a).toLocaleTimeString("en-US",{hour:"2-digit",minute:"2-digit",second:"2-digit"})},playApprovedSound(){},playDeniedSound(){},saveScanData(){const a={scannedToday:this.scannedToday,approvedToday:this.approvedToday,blockedToday:this.blockedToday,scanHistory:this.scanHistory,date:new Date().toDateString()};localStorage.setItem("guardScanData",JSON.stringify(a))},loadScanData(){const a=localStorage.getItem("guardScanData");if(a){const t=JSON.parse(a);t.date===new Date().toDateString()&&(this.scannedToday=t.scannedToday||0,this.approvedToday=t.approvedToday||0,this.blockedToday=t.blockedToday||0,this.scanHistory=t.scanHistory||[])}},logout(){this.$inertia.post(route("logout"))},handleImageUpload(a){const t=a.target.files[0];if(!t)return;if(!t.type.startsWith("image/")){alert("Please upload a valid image file");return}if(t.size>10*1024*1024){alert("Image file size should be less than 10MB");return}const u=new FileReader;u.onload=b=>{this.uploadedImage={file:t,preview:b.target.result,name:t.name}},u.readAsDataURL(t),a.target.value=""},async processUploadedImage(){if(this.uploadedImage){this.processingImage=!0;try{const a=new FormData;a.append("qr_image",this.uploadedImage.file),this.$inertia.post("/guard/scan-image",a,{preserveState:!0,preserveScroll:!0,onSuccess:t=>{t.props.flash&&t.props.flash.scanResult?(this.handleScanResult(t.props.flash.scanResult),this.clearUploadedImage()):t.props.scanResult&&(this.handleScanResult(t.props.scanResult),this.clearUploadedImage()),this.processingImage=!1},onError:t=>{console.error("Upload errors:",t),this.handleScanResult({status:"error",approved:!1,message:`Failed to process QR code: ${Object.values(t)[0]||"Upload failed"}`,book:null}),this.processingImage=!1}})}catch(a){console.error("Error processing image:",a),this.handleScanResult({status:"error",approved:!1,message:`Failed to process QR code: ${a.message}`,book:null}),this.processingImage=!1}}},clearUploadedImage(){this.uploadedImage=null}},mounted(){this.loadScanData(),this.flash&&this.flash.scanResult&&this.handleScanResult(this.flash.scanResult),this.scanResult&&this.handleScanResult(this.scanResult)},beforeUnmount(){this.stopScanner()}},T={class:"min-h-screen bg-gradient-to-br from-slate-900 via-purple-900 to-slate-900"},B={class:"relative z-10 bg-black/20 backdrop-blur-lg border-b border-white/10"},D={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-3 lg:py-4"},U={class:"flex items-center justify-between"},j={class:"flex items-center space-x-2 lg:space-x-4"},A={class:"hidden md:block text-right"},C={class:"text-white font-medium text-sm lg:text-base"},E={class:"relative z-10 max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-4 sm:py-6 lg:py-8"},H={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-4 lg:gap-6 mb-6 lg:mb-8"},O={class:"bg-black/30 backdrop-blur-lg rounded-xl lg:rounded-2xl border border-white/10 p-4 lg:p-6 hover:border-purple-500/50 transition-all duration-300"},N={class:"text-xl lg:text-2xl font-bold text-white mb-1"},z={class:"bg-black/30 backdrop-blur-lg rounded-xl lg:rounded-2xl border border-white/10 p-4 lg:p-6 hover:border-cyan-500/50 transition-all duration-300"},P={class:"text-xl lg:text-2xl font-bold text-white mb-1"},F={class:"bg-black/30 backdrop-blur-lg rounded-xl lg:rounded-2xl border border-white/10 p-4 lg:p-6 hover:border-red-500/50 transition-all duration-300"},M={class:"text-xl lg:text-2xl font-bold text-white mb-1"},Q={class:"grid grid-cols-1 xl:grid-cols-2 gap-6 lg:gap-8"},V={class:"bg-black/30 backdrop-blur-lg rounded-xl lg:rounded-2xl border border-white/10 p-6 lg:p-8 hover:border-purple-500/50 transition-all duration-300"},L={class:"space-y-3 lg:space-y-4"},q={class:"relative"},G=["disabled"],J={class:"relative"},K={key:0,class:"relative w-full max-h-64 bg-black/50 rounded-xl border-2 border-cyan-500/50 overflow-hidden"},W=["src","alt"],X={class:"absolute top-2 right-2 flex space-x-2"},Y={key:0,class:"absolute inset-0 bg-black/70 flex items-center justify-center"},Z={class:"relative w-full h-64 bg-black/50 rounded-xl border-2 border-dashed border-purple-500/50 flex items-center justify-center overflow-hidden"},$={key:0,class:"text-center"},ee={key:1,class:"absolute inset-0 flex items-center justify-center z-10"},te={class:"bg-black/30 backdrop-blur-lg rounded-2xl border border-white/10 p-8"},se={key:0,class:"mb-6"},ae={class:"flex items-center justify-between mb-4"},le={class:"flex items-center"},re={class:"text-lg font-bold text-white"},oe={key:0,class:"bg-black/30 rounded-lg p-4"},ne={class:"text-white font-medium mb-2"},de={class:"grid grid-cols-2 gap-4 text-sm"},ie={class:"text-white ml-2"},ce={key:1,class:"space-y-3 max-h-96 overflow-y-auto"},ue={class:"flex items-center justify-between"},pe={class:"flex items-center"},ge={class:"text-white text-sm font-medium"},be={key:2,class:"text-center py-12"},me={ref:"approvedSound",preload:"none"},xe={ref:"deniedSound",preload:"none"};function he(a,t,u,b,s,r){var m,x;return i(),n("div",T,[t[31]||(t[31]=e("div",{class:"absolute inset-0 overflow-hidden"},[e("div",{class:"absolute -top-4 -right-4 w-32 h-32 bg-purple-500/20 rounded-full blur-3xl animate-pulse"}),e("div",{class:"absolute top-1/3 -left-8 w-48 h-48 bg-blue-500/10 rounded-full blur-3xl animate-pulse delay-1000"}),e("div",{class:"absolute bottom-1/4 xright-1/3 w-40 h-40 bg-cyan-500/15 rounded-full blur-3xl animate-pulse delay-2000"})],-1)),e("header",B,[e("div",D,[e("div",U,[t[11]||(t[11]=p('<div class="flex items-center space-x-3 lg:space-x-4" data-v-1b7988ac><div class="relative" data-v-1b7988ac><div class="w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-lg lg:rounded-xl flex items-center justify-center shadow-lg" data-v-1b7988ac><i class="fas fa-shield-alt text-white text-lg lg:text-xl" data-v-1b7988ac></i></div><div class="absolute -top-1 -right-1 w-3 h-3 lg:w-4 lg:h-4 bg-green-500 rounded-full border-2 border-slate-900 animate-pulse" data-v-1b7988ac></div></div><div data-v-1b7988ac><h1 class="text-lg sm:text-xl lg:text-2xl font-bold bg-gradient-to-r from-white to-purple-200 bg-clip-text text-transparent" data-v-1b7988ac> Security Guard Dashboard </h1><p class="text-purple-200/80 text-xs sm:text-sm hidden sm:block" data-v-1b7988ac>Library Exit Scanner System</p></div></div>',1)),e("div",j,[e("div",A,[e("p",C,o(((x=(m=a.$page.props.auth)==null?void 0:m.user)==null?void 0:x.fullname)||"Guard User"),1),t[9]||(t[9]=e("p",{class:"text-purple-200/60 text-xs lg:text-sm"},"On Duty",-1))]),e("button",{onClick:t[0]||(t[0]=(...l)=>r.logout&&r.logout(...l)),class:"px-3 lg:px-4 py-2 bg-red-500/20 hover:bg-red-500/30 border border-red-500/50 rounded-lg text-red-200 transition-all duration-300 hover:shadow-lg hover:shadow-red-500/25 text-sm lg:text-base"},t[10]||(t[10]=[e("i",{class:"fas fa-sign-out-alt mr-1 lg:mr-2"},null,-1),e("span",{class:"hidden sm:inline"},"Logout",-1)]))])])])]),e("main",E,[e("div",H,[e("div",O,[t[12]||(t[12]=e("div",{class:"flex items-center justify-between mb-3 lg:mb-4"},[e("div",{class:"w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-green-500 to-emerald-500 rounded-lg lg:rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-qrcode text-white text-sm lg:text-base"})]),e("span",{class:"text-green-400 text-xs lg:text-sm font-medium"},"Today")],-1)),e("h3",N,o(s.scannedToday),1),t[13]||(t[13]=e("p",{class:"text-purple-200/70 text-sm lg:text-base"},"Books Scanned",-1))]),e("div",z,[t[14]||(t[14]=e("div",{class:"flex items-center justify-between mb-3 lg:mb-4"},[e("div",{class:"w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-blue-500 to-cyan-500 rounded-lg lg:rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-check-circle text-white text-sm lg:text-base"})]),e("span",{class:"text-blue-400 text-xs lg:text-sm font-medium"},"Approved")],-1)),e("h3",P,o(s.approvedToday),1),t[15]||(t[15]=e("p",{class:"text-purple-200/70 text-sm lg:text-base"},"Books Approved",-1))]),e("div",F,[t[16]||(t[16]=e("div",{class:"flex items-center justify-between mb-3 lg:mb-4"},[e("div",{class:"w-10 h-10 lg:w-12 lg:h-12 bg-gradient-to-r from-red-500 to-pink-500 rounded-lg lg:rounded-xl flex items-center justify-center"},[e("i",{class:"fas fa-times-circle text-white text-sm lg:text-base"})]),e("span",{class:"text-red-400 text-xs lg:text-sm font-medium"},"Blocked")],-1)),e("h3",M,o(s.blockedToday),1),t[17]||(t[17]=e("p",{class:"text-purple-200/70 text-sm lg:text-base"},"Books Blocked",-1))])]),e("div",Q,[e("div",V,[t[25]||(t[25]=p('<div class="text-center mb-4 lg:mb-6" data-v-1b7988ac><div class="w-16 h-16 lg:w-20 lg:h-20 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-xl lg:rounded-2xl flex items-center justify-center mx-auto mb-3 lg:mb-4 shadow-lg shadow-purple-500/25" data-v-1b7988ac><i class="fas fa-camera text-white text-xl lg:text-2xl" data-v-1b7988ac></i></div><h2 class="text-xl lg:text-2xl font-bold text-white mb-1 lg:mb-2" data-v-1b7988ac>QR Code Scanner</h2><p class="text-purple-200/70 text-sm lg:text-base" data-v-1b7988ac>Scan book QR codes to verify exit permission</p></div>',1)),e("div",L,[e("button",{onClick:t[1]||(t[1]=(...l)=>r.toggleScanner&&r.toggleScanner(...l)),class:d(["w-full py-3 lg:py-4 px-4 lg:px-6 rounded-xl font-semibold text-white transition-all duration-300 transform hover:scale-105 text-sm lg:text-base",s.scannerActive?"bg-gradient-to-r from-red-500 to-pink-500 hover:from-red-600 hover:to-pink-600 shadow-lg shadow-red-500/25":"bg-gradient-to-r from-purple-500 to-cyan-500 hover:from-purple-600 hover:to-cyan-600 shadow-lg shadow-purple-500/25"])},[e("i",{class:d(s.scannerActive?"fas fa-stop mr-2 lg:mr-3":"fas fa-camera mr-2 lg:mr-3")},null,2),g(" "+o(s.scannerActive?"Stop Scanner":"Start Scanner"),1)],2),e("div",q,[f(e("input",{"onUpdate:modelValue":t[2]||(t[2]=l=>s.manualBookId=l),onKeyup:t[3]||(t[3]=w((...l)=>r.scanManualBookId&&r.scanManualBookId(...l),["enter"])),type:"text",placeholder:"Enter Book ID manually...",class:"w-full px-3 lg:px-4 py-2 lg:py-3 bg-white/10 border border-white/20 rounded-xl text-white placeholder-purple-200/50 focus:outline-none focus:border-purple-500 focus:bg-white/15 transition-all duration-300 text-sm lg:text-base pr-16 lg:pr-20"},null,544),[[y,s.manualBookId]]),e("button",{onClick:t[4]||(t[4]=(...l)=>r.scanManualBookId&&r.scanManualBookId(...l)),disabled:!s.manualBookId.trim(),class:"absolute right-2 top-1/2 transform -translate-y-1/2 px-3 lg:px-4 py-1 lg:py-1.5 bg-gradient-to-r from-purple-500 to-cyan-500 rounded-lg text-white text-xs lg:text-sm font-medium disabled:opacity-50 disabled:cursor-not-allowed hover:shadow-lg transition-all duration-300"}," Scan ",8,G)]),e("div",J,[e("input",{ref:"imageUpload",onChange:t[5]||(t[5]=(...l)=>r.handleImageUpload&&r.handleImageUpload(...l)),type:"file",accept:"image/*",class:"hidden"},null,544),e("button",{onClick:t[6]||(t[6]=l=>a.$refs.imageUpload.click()),class:"w-full px-4 py-3 bg-white/10 border border-white/20 rounded-xl text-white hover:bg-white/15 focus:outline-none focus:border-cyan-500 transition-all duration-300 flex items-center justify-center"},t[18]||(t[18]=[e("i",{class:"fas fa-image mr-3 text-cyan-400"},null,-1),e("span",null,"Upload QR Code Image",-1)]))]),s.uploadedImage?(i(),n("div",K,[e("img",{src:s.uploadedImage.preview,alt:s.uploadedImage.name,class:"w-full h-full object-contain"},null,8,W),e("div",X,[e("button",{onClick:t[7]||(t[7]=(...l)=>r.processUploadedImage&&r.processUploadedImage(...l)),class:"px-3 py-1.5 bg-green-500 hover:bg-green-600 text-white text-sm rounded-lg transition-all duration-300"},t[19]||(t[19]=[e("i",{class:"fas fa-search mr-1"},null,-1),g(" Process QR ")])),e("button",{onClick:t[8]||(t[8]=(...l)=>r.clearUploadedImage&&r.clearUploadedImage(...l)),class:"px-3 py-1.5 bg-red-500 hover:bg-red-600 text-white text-sm rounded-lg transition-all duration-300"},t[20]||(t[20]=[e("i",{class:"fas fa-times"},null,-1)]))]),s.processingImage?(i(),n("div",Y,t[21]||(t[21]=[e("div",{class:"text-center"},[e("div",{class:"w-8 h-8 border-4 border-cyan-500 border-t-transparent rounded-full animate-spin mb-2"}),e("p",{class:"text-cyan-200 text-sm"},"Processing QR Code...")],-1)]))):c("",!0)])):c("",!0),f(e("div",Z,[s.cameraReady?c("",!0):(i(),n("div",$,t[22]||(t[22]=[e("div",{class:"w-12 h-12 border-4 border-purple-500 border-t-transparent rounded-full animate-spin mx-auto mb-4"},null,-1),e("p",{class:"text-purple-200"},"Initializing camera...",-1)]))),s.scanning?(i(),n("div",ee,t[23]||(t[23]=[e("div",{class:"w-32 h-1 bg-gradient-to-r from-transparent via-cyan-400 to-transparent animate-pulse"},null,-1)]))):c("",!0),t[24]||(t[24]=p('<div class="absolute inset-4 border-2 border-cyan-400 rounded-lg" data-v-1b7988ac><div class="absolute top-0 left-0 w-6 h-6 border-t-2 border-l-2 border-cyan-400" data-v-1b7988ac></div><div class="absolute top-0 right-0 w-6 h-6 border-t-2 border-r-2 border-cyan-400" data-v-1b7988ac></div><div class="absolute bottom-0 left-0 w-6 h-6 border-b-2 border-l-2 border-cyan-400" data-v-1b7988ac></div><div class="absolute bottom-0 right-0 w-6 h-6 border-b-2 border-r-2 border-cyan-400" data-v-1b7988ac></div></div>',1))],512),[[k,s.scannerActive&&!s.uploadedImage]])])]),e("div",te,[t[30]||(t[30]=e("h2",{class:"text-2xl font-bold text-white mb-6 flex items-center"},[e("i",{class:"fas fa-list-alt mr-3 text-purple-400"}),g(" Scan Results ")],-1)),s.lastScanResult?(i(),n("div",se,[e("div",{class:d(["p-6 rounded-xl border-2 transition-all duration-500 transform",s.lastScanResult.approved?"bg-green-500/20 border-green-500/50 shadow-lg shadow-green-500/25":"bg-red-500/20 border-red-500/50 shadow-lg shadow-red-500/25"])},[e("div",ae,[e("div",le,[e("i",{class:d(["text-2xl mr-3",s.lastScanResult.approved?"fas fa-check-circle text-green-400":"fas fa-times-circle text-red-400"])},null,2),e("div",null,[e("h3",re,o(s.lastScanResult.approved?"APPROVED":"NOT APPROVED"),1),e("p",{class:d(["text-sm opacity-80",s.lastScanResult.approved?"text-green-200":"text-red-200"])},o(s.lastScanResult.message),3)])]),e("span",{class:d(["text-xs opacity-60",s.lastScanResult.approved?"text-green-200":"text-red-200"])}," Just now ",2)]),s.lastScanResult.book?(i(),n("div",oe,[e("h4",ne,o(s.lastScanResult.book.title),1),e("div",de,[e("div",null,[t[26]||(t[26]=e("span",{class:"text-purple-200/70"},"Author:",-1)),e("span",ie,o(s.lastScanResult.book.author),1)]),e("div",null,[t[27]||(t[27]=e("span",{class:"text-purple-200/70"},"Status:",-1)),e("span",{class:d(["ml-2 px-2 py-1 rounded text-xs font-medium",r.getStatusBadgeClass(s.lastScanResult.book.availability)])},o(s.lastScanResult.book.availability),3)])])])):c("",!0)],2)])):c("",!0),s.scanHistory.length>0?(i(),n("div",ce,[t[28]||(t[28]=e("h3",{class:"text-lg font-semibold text-white mb-3"},"Recent Scans",-1)),(i(!0),n(S,null,R(s.scanHistory,(l,v)=>{var h;return i(),n("div",{key:v,class:d(["p-4 rounded-lg border transition-all duration-300 hover:shadow-lg",l.approved?"bg-green-500/10 border-green-500/30 hover:shadow-green-500/10":"bg-red-500/10 border-red-500/30 hover:shadow-red-500/10"])},[e("div",ue,[e("div",pe,[e("i",{class:d(["text-sm mr-2",l.approved?"fas fa-check text-green-400":"fas fa-times text-red-400"])},null,2),e("div",null,[e("span",ge,o(((h=l.book)==null?void 0:h.title)||"Unknown Book"),1),e("span",{class:d(["text-xs ml-2 opacity-60",l.approved?"text-green-200":"text-red-200"])},o(r.formatTime(l.timestamp)),3)])]),e("span",{class:d(["px-2 py-1 rounded text-xs",l.approved?"bg-green-500/20 text-green-200":"bg-red-500/20 text-red-200"])},o(l.approved?"Allowed":"Blocked"),3)])],2)}),128))])):(i(),n("div",be,t[29]||(t[29]=[e("i",{class:"fas fa-qrcode text-6xl text-purple-500/30 mb-4"},null,-1),e("p",{class:"text-purple-200/70"},"No scans yet today",-1),e("p",{class:"text-purple-200/50 text-sm"},"Start scanning books to see results here",-1)])))])])]),e("audio",me,null,512),e("audio",xe,null,512)])}const ye=I(_,[["render",he],["__scopeId","data-v-1b7988ac"]]);export{ye as default};
